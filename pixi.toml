[workspace]
authors = ["Lukas Hermann"]
platforms = ["osx-arm64"]
channels = ["https://conda.modular.com/max-nightly", "conda-forge"]
preview = ["pixi-build"]

[package]
name = "Shimmer"
version = "0.1.0"
description = "A creative coding framework for Mojo"

[package.build]
backend = { name = "pixi-build-rattler-build", version = "*" }

[dependencies]
mojo = ">=0.25.7.0.dev2025110305,<0.26"
max = ">=25.7.0.dev2025110305,<26"
wgpu-mojo = { git = "https://github.com/lsh/wgpu-mojo" }
glfw = ">=3.4,<4"
wgpu-native = ">=22.1.0,<23"

[tasks]
setup = { cmd = "mkdir -p build" }
build = { cmd = "bash fix_dylib.sh", depends-on = ["setup"] }
exec = { cmd = "./build/main", depends-on = ["build"] }
# Quick build without fixing library paths (for development)
quick-build = { cmd = "mojo build main.mojo" }

[activation.env]
MODULAR_MOJO_MAX_SYSTEM_LIBS = "-lm,-L.pixi/envs/default/lib/,-lglfw,-lwgpu_native"

# [target.linux-64.activation]
# env = { MODULAR_MOJO_MAX_SYSTEM_LIBS = "-lrt,-ldl,-lpthread,-lm,-L/opt/cuda/lib/,-L.pixi/envs/default/lib/,-L/usr/lib/,-lGL,-lEGL, shlglfw,-lglad,-lportaudio,-lwgpu_native" }
